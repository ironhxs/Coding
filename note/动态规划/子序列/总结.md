# 动态规划 · 子序列｜总结

关键：子序列不要求连续、状态定义清晰、转移条件明确、边界处理。

## 模板要点（抽象而非整段代码）

- 最长递增子序列类（经典LIS）
  - 状态：dp[i] 表示以第i个元素结尾的最长递增子序列长度
  - 转移：dp[i] = max(dp[i], dp[j] + 1) 其中 nums[j] < nums[i]
  - 核心思想：枚举所有可能的前驱位置，选择最优解
  - 复杂度：O(n²)，可优化到O(nlogn)

- 摆动序列类（交替变化）
  - 状态：dp[i] 表示以第i个元素结尾的最长摆动序列长度
  - 辅助状态：sym[i] 表示第i个元素相对于前一个元素的符号(1:上升, -1:下降, 0:未定)
  - 转移：根据前一个元素的符号状态，选择合适的方向转移
  - 核心思想：维护符号状态，确保相邻元素差值正负交替

- 最长递增子序列个数类（计数DP）
  - 状态：len[i] 表示以第i个元素结尾的LIS长度，count[i] 表示路径个数
  - 转移：
    - 长度相等：count[i] += count[j]
    - 长度更长：count[i] = count[j]
  - 核心思想：同时维护长度和个数，最后统计所有达到最长长度的路径数

- 数对链类（排序+LIS）
  - 预处理：按第一个元素排序
  - 状态：dp[i] 表示以第i个数对结尾的最长链长度
  - 转移：dp[i] = max(dp[i], dp[j] + 1) 其中 pairs[j][1] < pairs[i][0]
  - 核心思想：转化为LIS问题，通过排序简化判断条件

- 定差子序列类（哈希表优化）
  - 状态：hash_dp[x] 表示以数值x结尾的最长定差子序列长度
  - 转移：hash_dp[x] = hash_dp[x-diff] + 1
  - 核心思想：利用定差特性，用哈希表O(1)查找前驱，避免O(n²)超时

- 等差/斐波那契子序列类（二维DP）
  - 状态：dp[i][j] 表示以第i,j个元素结尾的子序列长度/个数
  - 转移：通过计算前驱位置k，dp[i][j] = dp[k][i] + 1
  - 核心思想：固定后两个元素，用哈希表查找前驱，注意溢出处理

## 复杂度
- 时间复杂度：O(n²)（可优化到O(nlogn)）
- 空间复杂度：O(n)

## 题目索引（代码与力扣链接）

### 经典LIS类
- 300 最长递增子序列 — [代码](../../../code/动态规划/子序列/300%20最长递增子序列.cpp) | [LeetCode](https://leetcode.cn/problems/longest-increasing-subsequence/)
- 376 摆动序列 — [代码](../../../code/动态规划/子序列/376%20摆动序列.cpp) | [LeetCode](https://leetcode.cn/problems/wiggle-subsequence/)
- 673 最长递增子序列的个数 — [代码](../../../code/动态规划/子序列/673%20最长递增子序列的个数.cpp) | [LeetCode](https://leetcode.cn/problems/number-of-longest-increasing-subsequence/)
- 646 最长数对链 — [代码](../../../code/动态规划/子序列/646%20最长数对链.cpp) | [LeetCode](https://leetcode.cn/problems/maximum-length-of-pair-chain/)

### 等差/斐波那契子序列类
- 1218 最长定差子序列 — [代码](../../../code/动态规划/子序列/1218%20最长定差子序列.cpp) | [LeetCode](https://leetcode.cn/problems/longest-arithmetic-subsequence-of-given-difference/)
- 873 最长的斐波那契子序列的长度 — [代码](../../../code/动态规划/子序列/873%20最长的斐波那契子序列的长度.cpp) | [LeetCode](https://leetcode.cn/problems/length-of-longest-fibonacci-subsequence/)
- 1027 最长等差数列 — [代码](../../../code/动态规划/子序列/1027%20最长等差数列.cpp) | [LeetCode](https://leetcode.cn/problems/longest-arithmetic-subsequence/)
- 446 等差数列划分 II - 子序列 — [代码](../../../code/动态规划/子序列/446%20等差数列划分%20II%20-%20子序列.cpp) | [LeetCode](https://leetcode.cn/problems/arithmetic-slices-ii-subsequence/)
